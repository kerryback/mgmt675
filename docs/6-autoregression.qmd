---
title: MGMT 675<br>AI-Assisted Financial Analysis<br><img src="RiceBusiness-transparent-logo-sm.png"  height=100><br>Autoregression
title-slide-attributes:
  data-background-image: https://www.dropbox.com/scl/fi/pr7qqxrnapwfsejk09e7m/ml3.jpg?rlkey=4n75omh9zh2i736dcru9gxp6l&dl=1
  data-background-position: right
  data-background-opacity: "0.55"
include-in-header:
  - text: |
      <style>
      #title-slide .title {
        color: #00205B;
      }
      </style>
execute:
  echo: false
  jupyter: python3
  cache: true
format: 
  revealjs:
    highlight-style: monokai
    code-fold: true
    code-copy: hover
    scrollable: true
    slide-number: true
    preview-links: true
    self-contained: true
    controls: true
    transition: fade
    theme: [solarized, 2023.scss]
    incremental: false
    code-line-numbers: false
---

## Overview

- We want to forecast a time series.
  - returns, interest rates, oil price, cash flows, ...
- Possible models:
  - ARIMA (autoregressive integrated moving average)
  - exponential smoothing
  - neural networks
- We'll do AR models.

## Autocorrelations

- Autocorrelation = correlation of a variable with its lagged value
- First-order autocorrelation $=\text{corr}(x_t, x_{t+1})$
- $p$--th order autocorrelation $=\text{corr}(x_t, x_{t+p})$
  - E.g., $p=12$ in monthly data or $p=4$ in quarterly data because of seasonality

## Autocorrelation of HML

- Ask Julius to use pandas-datareader to download the monthly Fama-French factors from Ken French's data library.
- Ask Julius to produce a plot of the autocorrelation function (acf) for HML.

## Autoregressions 

- An autoregression is a regression of a variable on its own lags:
$$x_t = \alpha + \beta_1x_{t-1} + \cdots + \beta_px_{t-p} + \varepsilon_t$$
- Ask Julius to fit an AR(1) for HML.
- Ask Julius to use the AR(1) model to forecast HML for the next 12 months and to plot the last 2 years and the forecasts.

## More examples

Ask Julius to plot the ACF, fit an AR model, and forecast the following:

- Percent change in crude price: Ask Julius to use pandas-datareader to download crude oil prices starting in 1980 from FRED, to downsample to end-of-month, and to compute percent changes.

- Change in Treasury yields: Ask Julius to use pandas-datareader to download 10-year Treasury yields starting in 1980 from FRED, to downsample to monthly, and to compute changes.

## Vector Autoregression

- Forecast related variables based on their mutual lags
- Example: does this month's SMB return forecast next month's HML return?
- Ask Julius to run a VAR(1) on the Fama-French factors and provide a summary of the results.