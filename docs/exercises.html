<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f3c2ea88cadbcfb37ba28ffa2c97cfc1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-175319157c5a1d45805a17fae5d1b6b1.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MGMT 675</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./assignments.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./files.html"> 
<span class="menu-text">Files</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercises</h1>
<p class="subtitle lead">MGMT 675: Generative AI for Finance</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="course-introduction" class="level2">
<h2 class="anchored" data-anchor-id="course-introduction">00 – Course Introduction</h2>
<section id="exercise-0a-ai-use-cases-in-finance" class="level4">
<h4 class="anchored" data-anchor-id="exercise-0a-ai-use-cases-in-finance">Exercise 0A: AI Use Cases in Finance</h4>
<p>Pick a specific finance role (e.g., equity research analyst, credit underwriter, portfolio manager, compliance officer). Using Claude.ai, have a conversation in which you identify five concrete tasks that AI could automate or augment in that role. For each task, classify it as “maker” work or “checker” work (per the JP Morgan framing in the slides). Submit a one-page summary with your classifications and a brief argument for which task would deliver the most value if automated first.</p>
</section>
<section id="exercise-0b-ai-capabilities-audit" class="level4">
<h4 class="anchored" data-anchor-id="exercise-0b-ai-capabilities-audit">Exercise 0B: AI Capabilities Audit</h4>
<p>Choose a publicly traded company and ask Claude to (a) summarize its most recent earnings release, (b) pull its current P/E ratio from the web, and (c) generate a simple bar chart comparing its revenue over the past four quarters. For each task, note which AI capability from the slides it relies on (e.g., document analysis, web search, code execution). Submit screenshots of the conversation along with your capability mapping.</p>
</section>
<section id="exercise-0c-cross-model-evaluation" class="level4">
<h4 class="anchored" data-anchor-id="exercise-0c-cross-model-evaluation">Exercise 0C: Cross-Model Evaluation</h4>
<p>Ask Claude and at least one other AI (ChatGPT, Gemini, or Copilot) the same finance question: <em>“Explain the Modigliani-Miller theorem and its real-world limitations.”</em> Compare the two responses on accuracy, depth, and clarity. Then start a new Claude conversation and ask it to critique the other model’s answer. Submit all three outputs with a short reflection (half page) on what you learned about cross-evaluation.</p>
<hr>
</section>
</section>
<section id="claude.ai-desktop" class="level2">
<h2 class="anchored" data-anchor-id="claude.ai-desktop">01 – Claude.ai / Desktop</h2>
<section id="exercise-1a-interactive-bond-pricing-app" class="level4">
<h4 class="anchored" data-anchor-id="exercise-1a-interactive-bond-pricing-app">Exercise 1A: Interactive Bond Pricing App</h4>
<p>Using Claude.ai Artifacts, create an interactive app that lets a user input a bond’s coupon rate, yield to maturity, face value, and years to maturity (assume semi-annual coupons). The app should compute the bond price and display an interactive chart showing how the price changes as the yield varies from 0% to 15%. Publish the artifact and submit the shareable link.</p>
</section>
<section id="exercise-1b-iterative-prompting-for-a-financial-model" class="level4">
<h4 class="anchored" data-anchor-id="exercise-1b-iterative-prompting-for-a-financial-model">Exercise 1B: Iterative Prompting for a Financial Model</h4>
<p>Ask Claude.ai to create an Excel file that models a leveraged buyout (LBO) for a hypothetical company. Start with a rough prompt, then refine iteratively over at least four turns (e.g., add debt schedules, adjust assumptions, improve formatting). Keep a log of each prompt you sent and what changed in the output. Submit the final Excel file and your prompt log with a brief reflection on the plan-execute-evaluate cycle.</p>
</section>
<section id="exercise-1c-system-prompt-design" class="level4">
<h4 class="anchored" data-anchor-id="exercise-1c-system-prompt-design">Exercise 1C: System Prompt Design</h4>
<p>Write a system prompt (300–500 words) for a custom chatbot that serves as a “client portfolio advisor.” The prompt should define the chatbot’s persona, specify its areas of expertise, set guardrails (e.g., never give specific buy/sell recommendations), and describe the response format. Test your system prompt by pasting it into a new Claude conversation as the first message, then ask three client-style questions. Submit the system prompt and the three Q&amp;A exchanges.</p>
<hr>
</section>
</section>
<section id="mean-variance-optimization" class="level2">
<h2 class="anchored" data-anchor-id="mean-variance-optimization">02 – Mean-Variance Optimization</h2>
<section id="exercise-2a-tangency-portfolio-with-real-data" class="level4">
<h4 class="anchored" data-anchor-id="exercise-2a-tangency-portfolio-with-real-data">Exercise 2A: Tangency Portfolio with Real Data</h4>
<p>Download monthly return data for five ETFs of your choice (e.g., SPY, AGG, GLD, VNQ, EFA) and the one-month T-bill rate from a source such as FRED or Yahoo Finance. Upload the data to Claude and ask it to compute the tangency portfolio weights, the expected return and standard deviation of the tangency portfolio, and the Sharpe ratio. Have Claude plot the efficient frontier and the capital allocation line. Submit the Excel data file, the Claude conversation, and the final plot.</p>
</section>
<section id="exercise-2b-constrained-optimization-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-2b-constrained-optimization-comparison">Exercise 2B: Constrained Optimization Comparison</h4>
<p>Using the same data from Exercise 2A (or a new set of at least four assets), ask Claude to solve for the tangency portfolio under three scenarios: (a) unconstrained, (b) no short sales, and (c) maximum 40% in any single asset. Compare the portfolio weights, Sharpe ratios, and efficient frontiers across all three cases. Submit a one-page memo discussing how constraints affect diversification and performance.</p>
</section>
<section id="exercise-2c-solver-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-2c-solver-comparison">Exercise 2C: Solver Comparison</h4>
<p>Ask Claude to find the tangency portfolio for a set of at least three assets using two different Python solvers (e.g., scipy.minimize and cvxpy). Compare the results: Are the portfolio weights identical? How do computation times compare? Under what circumstances might one solver be preferred? Submit the code, the outputs, and a half-page discussion.</p>
<hr>
</section>
</section>
<section id="google-gemini-in-colab" class="level2">
<h2 class="anchored" data-anchor-id="google-gemini-in-colab">03 – Google Gemini in Colab</h2>
<section id="exercise-3a-stock-return-analysis-in-colab" class="level4">
<h4 class="anchored" data-anchor-id="exercise-3a-stock-return-analysis-in-colab">Exercise 3A: Stock Return Analysis in Colab</h4>
<p>In Google Colab, use Gemini to write code that downloads daily price data for three stocks of your choice from Yahoo Finance, computes daily returns, and produces (a) a boxplot of the daily returns, (b) a summary statistics table (mean, std, min, max, skewness, kurtosis), and (c) a correlation matrix heatmap. Save the notebook and the output files to Google Drive. Submit the notebook (.ipynb) and a screenshot of the outputs.</p>
</section>
<section id="exercise-3b-beta-estimation" class="level4">
<h4 class="anchored" data-anchor-id="exercise-3b-beta-estimation">Exercise 3B: Beta Estimation</h4>
<p>Download <a href="https://kerryback.com/mgmt675/files/betas.xlsx">betas.xlsx</a> to your Google Drive. In Colab, ask Gemini to mount your Drive, load the data, estimate betas for each stock using OLS regression, and create a bar chart of the estimated betas with 95% confidence intervals. Ask Gemini to interpret the results: which stocks are defensive and which are aggressive? Submit the notebook and a short written summary.</p>
</section>
<section id="exercise-3c-colab-vs.-claude-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-3c-colab-vs.-claude-comparison">Exercise 3C: Colab vs.&nbsp;Claude Comparison</h4>
<p>Perform the same analysis task in both Google Colab (with Gemini) and Claude.ai: compute the annualized mean return and volatility for a set of at least three stocks using one year of daily data. Compare the two experiences: Which was easier to set up? Which produced more reliable code on the first attempt? Which gave better explanations? Submit both outputs and a one-page comparison.</p>
<hr>
</section>
</section>
<section id="model-context-protocol" class="level2">
<h2 class="anchored" data-anchor-id="model-context-protocol">04 – Model Context Protocol</h2>
<section id="exercise-4a-financial-data-with-mcp" class="level4">
<h4 class="anchored" data-anchor-id="exercise-4a-financial-data-with-mcp">Exercise 4A: Financial Data with MCP</h4>
<p>Install the Alpha Vantage or Financial Modeling Prep MCP server in Claude Desktop. Use it to retrieve financial data for a company of your choice (e.g., income statement, balance sheet, or stock prices). Ask Claude to analyze the data and produce a summary table in Excel. Submit screenshots showing (a) the MCP server in your config, (b) the hammer icon with available tools, and (c) the final Excel output.</p>
</section>
<section id="exercise-4b-browser-automation-for-data-collection" class="level4">
<h4 class="anchored" data-anchor-id="exercise-4b-browser-automation-for-data-collection">Exercise 4B: Browser Automation for Data Collection</h4>
<p>Install the Browser-Use MCP server in Claude Desktop. Ask Claude to navigate to a financial website (e.g., Yahoo Finance or the SEC EDGAR site), extract a specific piece of data (e.g., the current market cap and P/E ratio for a company), and present it in a formatted response. Submit screenshots of the browser automation in action and the final result.</p>
</section>
<section id="exercise-4c-multi-server-workflow" class="level4">
<h4 class="anchored" data-anchor-id="exercise-4c-multi-server-workflow">Exercise 4C: Multi-Server Workflow</h4>
<p>Configure at least two MCP servers in Claude Desktop (e.g., DesktopCommander + a financial data server). Design a workflow where Claude uses both servers in a single conversation — for example, pulling financial data via the data server and then running a Python script via DesktopCommander to analyze it. Submit your config file (with API keys redacted), the conversation transcript, and the output.</p>
<hr>
</section>
</section>
<section id="claude-cowork" class="level2">
<h2 class="anchored" data-anchor-id="claude-cowork">05 – Claude Cowork</h2>
<section id="exercise-5a-portfolio-performance-report" class="level4">
<h4 class="anchored" data-anchor-id="exercise-5a-portfolio-performance-report">Exercise 5A: Portfolio Performance Report</h4>
<p>Create a CSV file containing monthly returns for at least three funds over the past two years. Place it in a folder on your computer. In Claude Desktop’s Cowork tab, point Claude at the folder and ask it to compute the Sharpe ratio for each fund, identify the top performer, and create an Excel spreadsheet with a summary table and a bar chart of the Sharpe ratios. Submit the CSV input, the Excel output, and a screenshot of the Cowork session.</p>
</section>
<section id="exercise-5b-multi-file-document-processing" class="level4">
<h4 class="anchored" data-anchor-id="exercise-5b-multi-file-document-processing">Exercise 5B: Multi-File Document Processing</h4>
<p>Download <a href="https://kerryback.com/mgmt675/files/exercise2_invoices.zip">exercise2_invoices.zip</a> and extract it into a folder. In Cowork, ask Claude to read the invoice register (PDF), the payment log (xlsx), and the vendor disputes memo (docx). Have Claude match invoices to payments, apply dispute resolutions, and produce a reconciliation summary with the total outstanding amount. Submit the input files and the reconciliation output.</p>
</section>
<section id="exercise-5c-cowork-vs.-code-mode-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-5c-cowork-vs.-code-mode-comparison">Exercise 5C: Cowork vs.&nbsp;Code Mode Comparison</h4>
<p>Perform the same data analysis task (e.g., computing descriptive statistics and a histogram for a dataset) in both the Cowork tab and the Code (Local) tab. Compare: Which was faster? Which used more tokens (check with /cost)? Which gave you more control over the output? Write a half-page reflection on when you would use each mode.</p>
<hr>
</section>
</section>
<section id="claude-desktop-in-code-mode" class="level2">
<h2 class="anchored" data-anchor-id="claude-desktop-in-code-mode">06 – Claude Desktop in Code Mode</h2>
<section id="exercise-6a-fama-french-regression" class="level4">
<h4 class="anchored" data-anchor-id="exercise-6a-fama-french-regression">Exercise 6A: Fama-French Regression</h4>
<p>Download or create a CSV file with monthly returns for five industry portfolios and the Fama-French three factors (Mkt-RF, SMB, HML) plus RF. In Claude Desktop’s Code tab (Local), ask Claude to run a Fama-French three-factor regression for each portfolio, save the results (alpha, betas, R-squared) to an Excel file, and create a plot of the estimated market betas with confidence intervals. Submit the data file, the Excel output, and the plot.</p>
</section>
<section id="exercise-6b-invoice-reconciliation-in-code-mode" class="level4">
<h4 class="anchored" data-anchor-id="exercise-6b-invoice-reconciliation-in-code-mode">Exercise 6B: Invoice Reconciliation in Code Mode</h4>
<p>Download <a href="https://kerryback.com/mgmt675/files/exercise2_invoices.zip">exercise2_invoices.zip</a> into your project folder. In Code (Local), ask Claude to extract the invoice table from the PDF, match invoices to payments from the Excel file (handling inconsistent reference formats), identify fully paid, partially paid, and unpaid invoices, and apply dispute resolutions from the Word memo. Ask for a final reconciliation summary. Submit the output and a brief description of the steps Claude took.</p>
</section>
<section id="exercise-6c-subagent-design" class="level4">
<h4 class="anchored" data-anchor-id="exercise-6c-subagent-design">Exercise 6C: Subagent Design</h4>
<p>In Claude Code, use the <code>/agents</code> command to create a custom subagent called “financial-analyst” that is specialized for analyzing CSV data files. Define its system prompt to include standards such as always annualizing returns, labeling chart axes, and saving results to Excel. Test the subagent on a sample dataset. Submit the agent’s markdown file (<code>.claude/agents/analyst.md</code>), the test conversation, and the output.</p>
<hr>
</section>
</section>
<section id="claude-add-in-for-excel" class="level2">
<h2 class="anchored" data-anchor-id="claude-add-in-for-excel">07 – Claude Add-In for Excel</h2>
<section id="exercise-7a-two-stage-dcf-in-excel" class="level4">
<h4 class="anchored" data-anchor-id="exercise-7a-two-stage-dcf-in-excel">Exercise 7A: Two-Stage DCF in Excel</h4>
<p>Open a blank Excel workbook and use the Claude Excel Add-in to build a two-stage DCF model. The model should include (a) explicit forecast period assumptions (revenue growth, margins, capex, etc.), (b) a terminal value calculation, (c) a WACC computation, and (d) a final enterprise value and implied share price. Ensure all calculations use Excel formulas, not hardcoded values. Submit the workbook.</p>
</section>
<section id="exercise-7b-beta-estimation-in-excel" class="level4">
<h4 class="anchored" data-anchor-id="exercise-7b-beta-estimation-in-excel">Exercise 7B: Beta Estimation in Excel</h4>
<p>Download <a href="https://kerryback.com/mgmt675/files/betas.xlsx">betas.xlsx</a> and open it in Excel with the Claude Add-in. Ask Claude to compute excess returns for WMT and run a regression to estimate its beta. Then ask Claude to create a scatter plot of excess returns with the regression line displayed. Submit the workbook with the regression results and chart.</p>
</section>
<section id="exercise-7c-debugging-a-broken-spreadsheet" class="level4">
<h4 class="anchored" data-anchor-id="exercise-7c-debugging-a-broken-spreadsheet">Exercise 7C: Debugging a Broken Spreadsheet</h4>
<p>Obtain or create an Excel workbook that contains several intentional errors: a #REF! error, a circular reference, a #DIV/0! error, and at least one hardcoded value that should be a formula. Open it with the Claude Add-in and ask Claude to identify and fix all errors. Submit the original (broken) workbook and the corrected version, along with Claude’s explanation of each fix.</p>
<hr>
</section>
</section>
<section id="claude-skills" class="level2">
<h2 class="anchored" data-anchor-id="claude-skills">08 – Claude Skills</h2>
<section id="exercise-8a-investment-memo-skill" class="level4">
<h4 class="anchored" data-anchor-id="exercise-8a-investment-memo-skill">Exercise 8A: Investment Memo Skill</h4>
<p>Create a Claude skill called <code>investment-memo</code> in your project’s <code>.claude/skills/</code> folder. The SKILL.md file should define the output format (executive summary, business overview, financial analysis, risk factors, recommendation), specify workflows, and include code examples. Test the skill by asking Claude to write an investment memo for a public company. Submit the SKILL.md file and the generated memo.</p>
</section>
<section id="exercise-8b-portfolio-report-skill" class="level4">
<h4 class="anchored" data-anchor-id="exercise-8b-portfolio-report-skill">Exercise 8B: Portfolio Report Skill</h4>
<p>Create a skill called <code>portfolio-report</code> that instructs Claude to generate a monthly portfolio performance report. The skill should specify the report structure (holdings summary, performance attribution, risk metrics, charts), require annualized returns and Sharpe ratios, and include a Python script template for generating charts. Test it with sample data. Submit the skill folder and the generated report.</p>
</section>
<section id="exercise-8c-skill-vs.-direct-prompting-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-8c-skill-vs.-direct-prompting-comparison">Exercise 8C: Skill vs.&nbsp;Direct Prompting Comparison</h4>
<p>Pick a recurring financial analysis task (e.g., analyzing a quarterly earnings release). First, perform the task by prompting Claude directly with detailed instructions. Then, create a skill that encodes those instructions and perform the same task using the skill. Compare the two outputs on consistency, quality, and effort. Submit both outputs and a half-page reflection on when skills add value over direct prompting.</p>
<hr>
</section>
</section>
<section id="claude-code-in-vs-code" class="level2">
<h2 class="anchored" data-anchor-id="claude-code-in-vs-code">09 – Claude Code in VS Code</h2>
<section id="exercise-9a-beta-estimation-with-word-report" class="level4">
<h4 class="anchored" data-anchor-id="exercise-9a-beta-estimation-with-word-report">Exercise 9A: Beta Estimation with Word Report</h4>
<p>In VS Code with Claude Code, open a folder containing <a href="https://kerryback.com/mgmt675/files/betas.xlsx">betas.xlsx</a>. Ask Claude Code to compute WMT’s excess returns, run a regression to estimate its beta, and produce a Word document containing a scatter plot of the data with the regression line and a discussion of why the beta is what it is. Submit the Word document and the Python script Claude wrote.</p>
</section>
<section id="exercise-9b-table-aggregation" class="level4">
<h4 class="anchored" data-anchor-id="exercise-9b-table-aggregation">Exercise 9B: Table Aggregation</h4>
<p>Download <a href="https://kerryback.com/mgmt675/files/aggregation.zip">aggregation.zip</a> into your VS Code project folder and extract the workbooks. Each workbook contains a table with similar but not identical columns and column names. Ask Claude Code to combine all tables into a single unified table, reconciling the varying column names and including all columns. Submit the combined table (as Excel or CSV) and a description of how Claude handled the name reconciliation.</p>
</section>
<section id="exercise-9c-jupyter-notebook-analysis" class="level4">
<h4 class="anchored" data-anchor-id="exercise-9c-jupyter-notebook-analysis">Exercise 9C: Jupyter Notebook Analysis</h4>
<p>Ask Claude Code to create a Jupyter notebook that (a) loads a financial dataset of your choice, (b) computes summary statistics, (c) creates at least two visualizations (e.g., time series plot and histogram), and (d) includes markdown cells explaining each step. Run the notebook and verify all cells execute without errors. Submit the completed notebook (.ipynb).</p>
<hr>
</section>
</section>
<section id="discounted-cash-flow-analysis" class="level2">
<h2 class="anchored" data-anchor-id="discounted-cash-flow-analysis">10 – Discounted Cash Flow Analysis</h2>
<section id="exercise-10a-full-dcf-valuation" class="level4">
<h4 class="anchored" data-anchor-id="exercise-10a-full-dcf-valuation">Exercise 10A: Full DCF Valuation</h4>
<p>Choose a publicly traded company. Ask Claude to build a complete DCF valuation using publicly available financial data. The analysis should include (a) a five-year revenue and free cash flow projection, (b) a terminal value estimate using both the perpetuity growth method and the exit multiple method, (c) a WACC calculation, and (d) a sensitivity table showing implied share prices under different WACC and growth rate assumptions. Submit the analysis as an Excel workbook with all formulas intact.</p>
</section>
<section id="exercise-10b-dcf-cross-check" class="level4">
<h4 class="anchored" data-anchor-id="exercise-10b-dcf-cross-check">Exercise 10B: DCF Cross-Check</h4>
<p>Perform a DCF valuation for a company using Claude, then start a new conversation and ask Claude to critique the valuation. Have the second conversation identify at least three questionable assumptions and suggest alternatives. Revise the model based on the critique. Submit the original valuation, the critique, and the revised valuation with a summary of changes.</p>
</section>
<section id="exercise-10c-comparable-companies-analysis" class="level4">
<h4 class="anchored" data-anchor-id="exercise-10c-comparable-companies-analysis">Exercise 10C: Comparable Companies Analysis</h4>
<p>Ask Claude to build a comparable companies (comps) analysis for a target company. The analysis should identify five peer companies, pull relevant multiples (EV/EBITDA, P/E, EV/Revenue), compute the median and mean multiples, and apply them to the target’s financials to derive an implied valuation range. Present the results in a formatted Excel workbook. Submit the workbook and a half-page memo discussing which multiples are most relevant for the industry.</p>
<hr>
</section>
</section>
<section id="retrieval-augmented-generation" class="level2">
<h2 class="anchored" data-anchor-id="retrieval-augmented-generation">11 – Retrieval Augmented Generation</h2>
<section id="exercise-11a-notebooklm-financial-analysis" class="level4">
<h4 class="anchored" data-anchor-id="exercise-11a-notebooklm-financial-analysis">Exercise 11A: NotebookLM Financial Analysis</h4>
<p>Upload at least three financial documents (e.g., a 10-K filing, an earnings call transcript, and an analyst report) for the same company into Google NotebookLM. Ask at least five questions about the company’s financial performance, strategy, and risk factors. Note how NotebookLM cites specific sources in its answers. Submit the five Q&amp;A pairs with citations and a brief assessment of answer quality.</p>
</section>
<section id="exercise-11b-rag-pipeline-in-colab" class="level4">
<h4 class="anchored" data-anchor-id="exercise-11b-rag-pipeline-in-colab">Exercise 11B: RAG Pipeline in Colab</h4>
<p>Work through the <a href="https://colab.research.google.com/gist/GiovanniPasq/ddfc4a09d16b5b97c5c532b5c49f7789/agentic_rag_for_dummies.ipynb">Agentic RAG for Dummies</a> notebook using a corporate annual report of your choice (not Walmart). Ask at least five finance-specific questions (e.g., revenue breakdown, risk factors, capital allocation plans). For each question, note whether the RAG system’s answer is grounded in the document or appears to be hallucinated. Submit the notebook and your evaluation of the five answers.</p>
</section>
<section id="exercise-11c-rag-vs.-direct-prompting" class="level4">
<h4 class="anchored" data-anchor-id="exercise-11c-rag-vs.-direct-prompting">Exercise 11C: RAG vs.&nbsp;Direct Prompting</h4>
<p>Choose a financial document (e.g., a 10-K filing). Ask Claude the same five questions about the document in two ways: (a) upload the document directly to Claude.ai and ask, (b) use NotebookLM or the RAG Colab notebook. Compare the answers on accuracy, level of detail, and citation quality. Submit all ten answers and a one-page comparison discussing when RAG adds value over direct context injection.</p>
<hr>
</section>
</section>
<section id="fine-tuning-and-small-language-models" class="level2">
<h2 class="anchored" data-anchor-id="fine-tuning-and-small-language-models">12 – Fine-Tuning and Small Language Models</h2>
<section id="exercise-12a-train-nanogpt-on-shakespeare" class="level4">
<h4 class="anchored" data-anchor-id="exercise-12a-train-nanogpt-on-shakespeare">Exercise 12A: Train nanoGPT on Shakespeare</h4>
<p>Follow the instructions in the slides to train a character-level GPT on Shakespeare’s complete works using Karpathy’s <a href="https://github.com/karpathy/nanoGPT">nanoGPT</a>. Run the training on CPU with the suggested hyperparameters. After training, generate a sample of pseudo-Shakespearean text. Submit (a) a screenshot of the training loss over iterations, (b) a generated text sample (at least 500 characters), and (c) a half-page reflection on what the model learned and where it fails.</p>
</section>
<section id="exercise-12b-gpt-from-scratch-notebook" class="level4">
<h4 class="anchored" data-anchor-id="exercise-12b-gpt-from-scratch-notebook">Exercise 12B: GPT from Scratch Notebook</h4>
<p>Work through the <a href="https://github.com/kevinpdev/gpt-from-scratch">GPT from Scratch</a> notebook. For each major section (tokenization, positional encoding, self-attention, transformer blocks, training loop, inference), write a one-paragraph explanation in your own words of what is happening and why. Submit the completed notebook with your explanations added as markdown cells.</p>
</section>
<section id="exercise-12c-rag-vs.-fine-tuning-analysis" class="level4">
<h4 class="anchored" data-anchor-id="exercise-12c-rag-vs.-fine-tuning-analysis">Exercise 12C: RAG vs.&nbsp;Fine-Tuning Analysis</h4>
<p>Write a one-page memo addressed to the CTO of a hypothetical asset management firm that is considering how to give its internal chatbot access to proprietary research reports. Compare three approaches: (a) RAG, (b) fine-tuning a pre-trained model, and (c) training a small language model. For each approach, discuss setup effort, data requirements, cost, privacy implications, and suitability for the firm’s needs. Recommend one approach and justify your choice.</p>
<hr>
</section>
</section>
<section id="building-an-ai-agent" class="level2">
<h2 class="anchored" data-anchor-id="building-an-ai-agent">13 – Building an AI Agent</h2>
<section id="exercise-13a-simple-chatbot" class="level4">
<h4 class="anchored" data-anchor-id="exercise-13a-simple-chatbot">Exercise 13A: Simple Chatbot</h4>
<p>Using Python and the OpenRouter API (or the Anthropic API), build a simple chatbot that (a) accepts user input in a loop, (b) maintains conversation history, (c) includes a finance-focused system prompt, and (d) displays responses. The chatbot should run in the terminal. Test it with at least five finance questions. Submit the Python script and a transcript of the test conversation.</p>
</section>
<section id="exercise-13b-database-agent" class="level4">
<h4 class="anchored" data-anchor-id="exercise-13b-database-agent">Exercise 13B: Database Agent</h4>
<p>Using Claude Code or a Python script, build an agent that has access to a SQL tool (using SQLite). Create a small SQLite database with at least two tables of financial data (e.g., stock prices and company fundamentals). Write a system prompt that describes the database schema. Implement the agent loop so the LLM can write SQL, execute it, see the results, and respond to the user. Submit the code, the database file, and a sample conversation.</p>
</section>
<section id="exercise-13c-agent-with-streamlit-ui" class="level4">
<h4 class="anchored" data-anchor-id="exercise-13c-agent-with-streamlit-ui">Exercise 13C: Agent with Streamlit UI</h4>
<p>Extend either Exercise 13A or 13B by adding a Streamlit web interface. The app should display a chat window where the user can type questions and see the agent’s responses. If using the database agent, display query results in a formatted table. Deploy the app locally and submit the code, a screenshot of the running app, and a brief description of how the agent loop integrates with Streamlit.</p>
<hr>
</section>
</section>
<section id="trading-on-news-with-ai" class="level2">
<h2 class="anchored" data-anchor-id="trading-on-news-with-ai">14 – Trading on News with AI</h2>
<section id="exercise-14a-headline-sentiment-classification" class="level4">
<h4 class="anchored" data-anchor-id="exercise-14a-headline-sentiment-classification">Exercise 14A: Headline Sentiment Classification</h4>
<p>Collect 20 recent financial news headlines (from sources like Reuters, Bloomberg, or Yahoo Finance). Using Claude or the OpenRouter API, classify each headline as positive, negative, or neutral for the stock mentioned. Also have Claude rate the magnitude (1–5) and relevance (low/medium/high). Compare Claude’s classifications with the actual stock price movement on the day of the headline. Submit the 20 headlines, Claude’s classifications, the actual price movements, and a summary of Claude’s accuracy.</p>
</section>
<section id="exercise-14b-finbert-vs.-llm-comparison" class="level4">
<h4 class="anchored" data-anchor-id="exercise-14b-finbert-vs.-llm-comparison">Exercise 14B: FinBERT vs.&nbsp;LLM Comparison</h4>
<p>Using Google Colab, run FinBERT (from HuggingFace’s <code>ProsusAI/finbert</code> model) on 10 financial headlines. Then classify the same headlines using an LLM (Claude or GPT via the API). Compare the two models’ sentiment predictions on accuracy, nuance, and speed. Identify at least two headlines where the models disagree and explain which model’s classification is more reasonable. Submit the notebook, the comparison table, and your analysis.</p>
</section>
<section id="exercise-14c-earnings-call-tone-analysis" class="level4">
<h4 class="anchored" data-anchor-id="exercise-14c-earnings-call-tone-analysis">Exercise 14C: Earnings Call Tone Analysis</h4>
<p>Find a recent earnings call transcript for a publicly traded company (available from Seeking Alpha, company investor relations pages, or SEC filings). Ask Claude to analyze the management’s tone on a scale from -5 (very bearish) to +5 (very bullish), identify forward-looking statements that differ from consensus expectations, and compare the current quarter’s tone to a prior quarter. Submit the transcript (or a link), Claude’s analysis, and a brief assessment of whether the tone analysis aligns with the stock’s subsequent performance.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>