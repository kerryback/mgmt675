\documentclass[aspectratio=169]{beamer}
\usetheme{metropolis}
\usepackage{appendixnumberbeamer}
\usepackage{booktabs, hyperref}

\input{mgmt675-style}

\subtitle{MGMT 675: Generative AI for Finance}
\title{Using AI in Excel}
\author{Kerry Back}
\date{}

\begin{document}

\maketitle

% ============================================================
% BACKGROUND
% ============================================================
\section{Background}

\begin{frame}{AI Can Create Spreadsheets with Python}
\begin{baritemize}
  \item Python libraries like \texttt{openpyxl} create/modify Excel files
  \item AI writes Python code that:
  \begin{itemize}
    \item Inserts data values into cells
    \item Writes Excel formulas (e.g., \texttt{=SUM(A1:A10)})
    \item Applies formatting (fonts, colors, borders)
    \item Creates charts and pivot tables
  \end{itemize}
  \item Result: fully functional spreadsheet with \alert{live formulas}
\end{baritemize}
\end{frame}

\begin{frame}{Formulas vs. Hardcoded Values}
\begin{columns}[T]
  \begin{column}{0.45\textwidth}
\begin{shadedbox}[title=\textbf{Hardcoded (Bad)}]
\small
\texttt{sheet['B10'] = 1500}
\vspace{0.3cm}

Cell shows 1500, but if inputs change, the total doesn't update.
\end{shadedbox}
\end{column}
\begin{column}{0.45\textwidth}
\begin{shadedbox}[title=\textbf{Formula (Good)}]
\small
\texttt{sheet['B10'] = '=SUM(B2:B9)'}
\vspace{0.3cm}

Cell contains a formula that recalculates when inputs change.
\end{shadedbox}
\end{column}
\end{columns}

\vspace{0.5cm}
\begin{shadedbox}
\centerline{AI must be instructed to use formulas, not compute values in Python}
\end{shadedbox}
\end{frame}

\begin{frame}{Two Ways AI Interacts with Spreadsheets}
\begin{columns}[T]
  \begin{column}{0.45\textwidth}
\begin{shadedbox}[title=\textbf{Inside Excel (Add-ins)}]
\begin{itemize}\small
  \item Sidebar panel in Excel
  \item Sees your current workbook
  \item Modifies cells directly
  \item Context-aware suggestions
  \item Examples: Claude for Excel, Microsoft Copilot, Google Sheets + Gemini
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.45\textwidth}
\begin{shadedbox}[title=\textbf{Outside Excel (Python)}]
\begin{itemize}\small
  \item Runs in terminal or IDE
  \item Creates/modifies .xlsx files
  \item You open result in Excel
  \item Full programming power
  \item Examples: Claude Code, ChatGPT
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\end{frame}

% ============================================================
% OVERVIEW
% ============================================================
\section{Overview}

\begin{frame}{What Is the Claude Excel Add-in?}
\begin{baritemize}
  \item AI sidebar that lives inside Excel
  \item Reads your workbook---all tabs, formulas, and structure
  \item Modifies cells directly while preserving formula dependencies
  \item Powered by Claude Opus 4.6 (switchable to Sonnet 4.5)
  \item Works with local files---\alert{no OneDrive required}
\end{baritemize}
\end{frame}

\begin{frame}{Plan Requirements}
\begin{baritemize}
  \item Requires Claude Pro (\$20/month), Max, Team, or Enterprise plan
  \item Shares your existing Claude usage pool
  \item Works with Excel 2016+ on Windows, Mac, and Excel for the web
  \item Supports \texttt{.xlsx} and \texttt{.xlsm} files
\end{baritemize}
\end{frame}

% ============================================================
% INSTALLATION
% ============================================================
\section{Installation}

\begin{frame}{Installing the Add-in}
\begin{barenumerate}
  \item Open Excel and go to the \textbf{Insert} tab in the ribbon
  \item Click \textbf{Get Add-ins} (or \textbf{Add-ins} on some versions)
  \item Search for \textbf{``Claude by Anthropic''}
  \item Click \textbf{Get It Now} and accept the permissions prompt
  \item The Claude icon appears in your ribbon
\end{barenumerate}

\vspace{0.3cm}
\begin{shadedbox}
\centerline{
  \href{https://marketplace.microsoft.com/en-us/product/saas/wa200009404?tab=overview}{Microsoft Marketplace: Claude by Anthropic}
}
\end{shadedbox}
\end{frame}

\begin{frame}{Launching Claude in Excel}
\begin{barenumerate}
  \item Click the \textbf{Claude icon} in the ribbon to open the sidebar
    \begin{itemize}
      \item Windows: \textbf{Home} tab $\rightarrow$ Add-ins
      \item Mac: \textbf{Tools} tab $\rightarrow$ Add-ins
    \end{itemize}
  \item Sign in with your Claude account credentials
  \item The sidebar now sees your open workbook
\end{barenumerate}
\end{frame}

\begin{frame}{Launch and Log In}
\begin{columns}
\begin{column}{0.5\textwidth}
\includegraphics[width=\textwidth]{images/launch_the_addin.png}
\end{column}
\begin{column}{0.5\textwidth}
\includegraphics[width=0.8\textwidth]{images/claude_add_in.png}
\end{column}
\end{columns}
\end{frame}

% ============================================================
% KEY FEATURES
% ============================================================
\section{Key Features}

\begin{frame}{What Claude Can Do in Excel}
\begin{columns}[T]
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Analysis \& Understanding}]
\begin{itemize}\footnotesize
  \item Ask questions about workbook content
  \item Get answers with clickable cell references
  \item Navigate multi-tab spreadsheets
  \item Trace formulas and dependencies
\end{itemize}
\end{shadedbox}
\begin{shadedbox}[title=\textbf{Error Resolution}]
\begin{itemize}\footnotesize
  \item Identify \texttt{\#REF!}, \texttt{\#VALUE!}, circular references
  \item Trace errors to their root cause
  \item Apply fixes preserving spreadsheet integrity
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Data Modification}]
\begin{itemize}\footnotesize
  \item Update assumptions preserving formulas
  \item Highlighted changes with explanations
  \item Sort, filter, conditional formatting
  \item Create charts and pivot tables
\end{itemize}
\end{shadedbox}
\begin{shadedbox}[title=\textbf{Model Building}]
\begin{itemize}\footnotesize
  \item Build spreadsheets from scratch
  \item Populate templates with formulas
  \item Create financial models
  \item Add data validation and dropdowns
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\end{frame}

% ============================================================
% TIPS AND LIMITATIONS
% ============================================================
\section{Tips and Limitations}

\begin{frame}{Best Practices}
\begin{baritemize}
  \item Always review changes before finalizing---Claude highlights what it modified
  \item Claude warns before overwriting existing data
  \item Optional: enable the \textbf{Claude Log} tab to track all actions in a session
  \item Long conversations are automatically compacted to maintain context
  \item Chat history does not persist between sessions
\end{baritemize}
\end{frame}

\begin{frame}{Limitations}
\begin{baritemize}
  \item Does not support \textbf{macros or VBA}
  \item Does not support Excel \textbf{data tables} (What-If Analysis)
  \item Not recommended for audit-critical calculations without human review
  \item \alert{Security:} only use with trusted spreadsheets---malicious content in cells could attempt to manipulate the AI
\end{baritemize}
\end{frame}

% ============================================================
% CLAUDE FOR EXCEL VS. ALTERNATIVES
% ============================================================

\begin{frame}{AI Spreadsheet Tools Compared}
\hypertarget{comparison}{}
\begin{center}
\scriptsize
\begin{tabular}{p{2.5cm} p{3.2cm} p{3.2cm} p{3.2cm}}
\toprule
 & \textbf{Claude for Excel} & \textbf{Microsoft Copilot} & \textbf{Google Sheets + Gemini} \\
\midrule
Cost & Claude Pro (\$20/mo) & M365 Copilot (\$30/mo) & Google One AI Pro (\$20/mo) \\
Platform & Excel (Win/Mac/Web) & Excel (Win/Mac/Web) & Google Sheets (Web) \\
OneDrive required & No & Yes (AutoSave on) & N/A (Google Drive) \\
Python execution & Server-side sandbox & Microsoft Cloud & Apps Script \\
Formula mode & Yes & Yes & Yes \\
VBA / macros & No & No & Apps Script only \\
\bottomrule
\end{tabular}
\end{center}
\vspace{0.2cm}
\begin{center}\small
\hyperlink{copilot-appendix}{\beamergotobutton{Microsoft Copilot details}} \quad
\hyperlink{gemini-appendix}{\beamergotobutton{Gemini for Sheets details}}
\end{center}
\end{frame}

% ============================================================
% EXERCISES
% ============================================================
\section{Exercises}

\begin{frame}{Exercises}
\begin{barenumerate}
  \item Open a new workbook.  Ask Claude to build a loan amortization table for a \$200{,}000 mortgage at 6.5\% for 30 years with monthly payments, and create a chart showing the principal vs.\ interest portions over time.
  \item Open a new workbook.  Ask Claude to create an example two-stage DCF analysis.
\end{barenumerate}
\end{frame}

\begin{frame}{Exercise for Claude.ai or Claude Desktop}

\begin{shadedbox}
\centerline{``Create an Excel workbook to illustrate two-stage DCF analysis.''}
\end{shadedbox}
\end{frame}

% ============================================================
% APPENDIX: MICROSOFT COPILOT IN EXCEL
% ============================================================
\appendix

\begin{frame}{Microsoft Copilot in Excel}
\hypertarget{copilot-appendix}{}
\begin{columns}[T]
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{What It Is}]
\begin{itemize}\small
  \item AI assistant built into the Excel ribbon
  \item Powered by GPT-5.2 (switchable to Claude Opus 4.5)
  \item Included with M365 Copilot add-on (\$30/user/mo on top of M365)
  \item Also available via Copilot Pro (\$20/mo on top of M365 Personal)
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Key Features}]
\begin{itemize}\small
  \item Natural language formula generation
  \item Agent Mode: autonomous multi-step tasks (build models, reshape tables, create charts)
  \item \texttt{=COPILOT()} function: AI prompts directly in cells
  \item Python in Excel: generates and runs Python code for advanced analytics
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\vspace{0.2cm}
\begin{center}\small
\hyperlink{comparison}{\beamerreturnbutton{Back to comparison}}
\end{center}
\end{frame}

\begin{frame}[shrink=3]{Copilot: Strengths and Limitations}
\begin{columns}[T]
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Strengths vs.\ Claude for Excel}]
\begin{itemize}\small
  \item \textbf{Agent Mode}: plans and executes multi-step tasks autonomously
  \item \textbf{\texttt{=COPILOT()} function}: AI as a cell formula---results update when data changes
  \item \textbf{Python in Excel}: pandas, matplotlib, scikit-learn inside the spreadsheet
  \item \textbf{Formula completion}: real-time suggestions as you type
  \item \textbf{Web search}: pulls live data with source citations
  \item \textbf{Enterprise ecosystem}: integrates with SharePoint, Teams, Power BI
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Limitations vs.\ Claude for Excel}]
\begin{itemize}\small
  \item \textbf{Expensive}: \$30/mo add-on on top of M365 (\$66--87/user/mo total for enterprise)
  \item \textbf{OneDrive dependency}: historically required cloud storage; local file support still rolling out
  \item \textbf{Table format required}: data must be formatted as Excel tables
  \item \textbf{Multi-sheet weakness}: struggles with complex cross-tab formula tracing
  \item \textbf{No audit trail}: Claude logs all AI-assisted changes to a separate tab
  \item \textbf{Accuracy caveat}: Microsoft warns against using \texttt{=COPILOT()} for tasks ``requiring accuracy or reproducibility''
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\vspace{0.2cm}
\begin{center}\small
\hyperlink{comparison}{\beamerreturnbutton{Back to comparison}}
\end{center}
\end{frame}

% ============================================================
% APPENDIX: GEMINI IN GOOGLE SHEETS
% ============================================================

\begin{frame}{Gemini in Google Sheets}
\hypertarget{gemini-appendix}{}
\begin{columns}[T]
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{What It Is}]
\begin{itemize}\small
  \item AI assistant built into Google Sheets (web only)
  \item Powered by Gemini 2.5 Pro (3.1 Pro rolling out)
  \item Included in Workspace Business Standard (\$14/user/mo) and above
  \item Consumer: Google One AI Pro (\$20/mo)
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Key Features}]
\begin{itemize}\small
  \item Natural language formula generation with explanations
  \item \texttt{=AI()} function: AI prompts directly in cells, with Google Search access
  \item ``Help me organize'': generate structured tables from a description
  \item Multi-step task execution from a single prompt (formatting, formulas, filters)
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\vspace{0.2cm}
\begin{center}\small
\hyperlink{comparison}{\beamerreturnbutton{Back to comparison}}
\end{center}
\end{frame}

\begin{frame}[shrink=3]{Gemini for Sheets: Strengths and Limitations}
\begin{columns}[T]
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Strengths vs.\ Claude for Excel}]
\begin{itemize}\small
  \item \textbf{Cloud-native}: works entirely in the browser, accessible from any device
  \item \textbf{Real-time collaboration}: multiple users with simultaneous AI assistance
  \item \textbf{\texttt{=AI()} function}: AI as a cell formula---can also query Google Search for live data
  \item \textbf{Google ecosystem}: deep integration with Drive, Gmail, BigQuery
  \item \textbf{Lower entry price}: included in Workspace Business Standard (\$14/user/mo)
  \item \textbf{Smart Fill}: auto-completes patterns as you type
\end{itemize}
\end{shadedbox}
\end{column}
\begin{column}{0.48\textwidth}
\begin{shadedbox}[title=\textbf{Limitations vs.\ Claude for Excel}]
\begin{itemize}\small
  \item \textbf{No desktop Excel}: Google Sheets only---Excel is the finance industry standard
  \item \textbf{Capacity limits}: Sheets caps at $\sim$10M cells; 200-cell AI analysis limit per request
  \item \textbf{Monthly cap}: 500 AI interactions/month
  \item \textbf{No VBA / Power Query}: uses Apps Script instead (different ecosystem)
  \item \textbf{Charts don't auto-update}: Gemini-generated charts are static snapshots
  \item \textbf{No offline access}: requires internet; Claude for Excel works in desktop Excel offline
\end{itemize}
\end{shadedbox}
\end{column}
\end{columns}
\vspace{0.2cm}
\begin{center}\small
\hyperlink{comparison}{\beamerreturnbutton{Back to comparison}}
\end{center}
\end{frame}

\end{document}
